# =====================================================
# Environment Configuration Template
# External Metrics Web Service
# =====================================================

# =====================================================
# Database Configuration
# =====================================================

# Primary database connection URL
# Format: postgresql://username:password@host:port/database_name
DATABASE_URL="postgresql://metrics_user:secure_password@localhost:5432/metrics_production"

# Shadow database URL for Prisma migrations
# Used during development and migration processes
SHADOW_DATABASE_URL="postgresql://metrics_user:secure_password@localhost:5432/metrics_shadow"

# Connection Pool Settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=10
DATABASE_POOL_TIMEOUT_MS=5000
DATABASE_QUERY_TIMEOUT_MS=10000

# Legacy PostgreSQL connection settings (for existing pg client)
DB_HOST=localhost
DB_PORT=5432
DB_NAME=metrics_production
DB_USER=metrics_user
DB_PASSWORD=secure_password
DB_POOL_SIZE=10
DB_SSL=false

# =====================================================
# Application Configuration
# =====================================================

# Server Configuration
PORT=3000
NODE_ENV=development
LOG_LEVEL=info

# API Configuration
API_VERSION=v1
API_BASE_PATH=/api/v1

# =====================================================
# Authentication Configuration
# =====================================================

# JWT Configuration
JWT_SECRET=your-super-secure-jwt-secret-key-here-change-in-production
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# Session Configuration
SESSION_SECRET=your-super-secure-session-secret-change-in-production

# =====================================================
# Multi-tenant Configuration
# =====================================================

# Default tenant configuration
DEFAULT_TENANT_DOMAIN=demo
DEFAULT_SUBSCRIPTION_PLAN=basic

# Tenant limits per subscription plan
BASIC_PLAN_USER_LIMIT=10
BASIC_PLAN_SESSION_LIMIT=1000
PRO_PLAN_USER_LIMIT=50
PRO_PLAN_SESSION_LIMIT=10000
ENTERPRISE_PLAN_USER_LIMIT=unlimited
ENTERPRISE_PLAN_SESSION_LIMIT=unlimited

# =====================================================
# External Service Configuration
# =====================================================

# Redis Configuration (for caching and session storage)
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_KEY_PREFIX=fortium:metrics:

# Kafka Configuration (for event streaming)
KAFKA_BROKERS=localhost:9092
KAFKA_CLIENT_ID=metrics-web-service
KAFKA_GROUP_ID=metrics-consumers

# =====================================================
# Monitoring and Analytics
# =====================================================

# Performance Monitoring
ENABLE_PERFORMANCE_MONITORING=true
PERFORMANCE_SAMPLE_RATE=0.1

# Query Performance
SLOW_QUERY_THRESHOLD_MS=1000
ENABLE_QUERY_LOGGING=true

# Analytics
ENABLE_ANALYTICS=true
ANALYTICS_BATCH_SIZE=100
ANALYTICS_FLUSH_INTERVAL_MS=5000

# =====================================================
# Security Configuration
# =====================================================

# CORS Settings
CORS_ORIGIN=http://localhost:3001,http://localhost:3000
CORS_CREDENTIALS=true

# Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Security Headers
ENABLE_HELMET=true
ENABLE_COMPRESSION=true

# =====================================================
# Development Configuration
# =====================================================

# Development Tools
ENABLE_PRISMA_STUDIO=true
ENABLE_API_DOCS=true
ENABLE_DEBUG_ROUTES=false

# Testing
TEST_DATABASE_URL="postgresql://metrics_user:secure_password@localhost:5432/metrics_test"
TEST_REDIS_URL=redis://localhost:6380

# =====================================================
# OpenTelemetry Configuration (Task 2.1)
# =====================================================

# Feature Flags - Gradual Rollout Control
OTEL_ENABLED=false
# Set to true to enable OTEL (start with development environment)

# Service Configuration
OTEL_SERVICE_NAME=fortium-monitoring-service
OTEL_SERVICE_VERSION=1.0.0
OTEL_SERVICE_NAMESPACE=fortium

# OTLP Exporter Configuration
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4318
OTEL_EXPORTER_OTLP_TRACES_ENDPOINT=http://localhost:4318/v1/traces
OTEL_EXPORTER_OTLP_METRICS_ENDPOINT=http://localhost:4318/v1/metrics

# Sampling Configuration
# Development: 1.0 (100% sampling)
# Production: 0.1 (10% sampling) - automatically set based on NODE_ENV
OTEL_TRACE_SAMPLE_RATE=1.0

# Export Intervals
OTEL_METRIC_EXPORT_INTERVAL=30000
OTEL_TRACE_TIMEOUT=10000

# Propagation
OTEL_PROPAGATORS=tracecontext,baggage,b3

# Resource Attributes (comma-separated key=value pairs)
OTEL_RESOURCE_ATTRIBUTES=deployment.environment=local,team=platform

# Prometheus Metrics
OTEL_ENABLE_PROMETHEUS=true
OTEL_PROMETHEUS_PORT=9464

# =====================================================
# Seq Logging Configuration (Existing)
# =====================================================

SEQ_SERVER_URL=http://localhost:5341
SEQ_API_KEY=
SEQ_BATCH_SIZE=100
SEQ_FLUSH_INTERVAL=30000
SEQ_REQUEST_TIMEOUT=10000
SEQ_ENABLE_TLS=false

# Log Ingestion API Configuration
LOG_INGESTION_RATE_LIMIT_WINDOW=60000
LOG_INGESTION_RATE_LIMIT_MAX=1000
LOG_MAX_ENTRIES_PER_BATCH=100
LOG_MAX_BATCH_SIZE_MB=5

# =====================================================
# Production Configuration Hints
# =====================================================

# In production, ensure you:
# 1. Generate strong, unique values for all secrets
# 2. Use environment-specific database URLs
# 3. Set NODE_ENV=production
# 4. Configure appropriate LOG_LEVEL (warn or error)
# 5. Set up proper SSL certificates for database connections
# 6. Use managed services for Redis and Kafka
# 7. Configure proper CORS origins
# 8. Set appropriate rate limits
# 9. Enable all security features
# 10. Set up proper monitoring and alerting
# 11. Start with OTEL_ENABLED=false, enable gradually
# 12. Monitor OTEL performance impact (<5ms target)