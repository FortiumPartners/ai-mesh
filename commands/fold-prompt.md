---
name: fold-prompt
description: Advanced Claude environment optimization through intelligent project analysis and context management
usage: /fold-prompt [analysis|optimize|validate|maintenance]
agent: general-purpose
allowed-tools: Read, Edit, Glob, Grep
---

# Fold-Prompt Command

**Purpose**: Advanced Claude environment optimization through intelligent project analysis, context management, and documentation enhancement for maximum productivity gains

**Trigger**:

- Starting work on a new project
- Project documentation needs optimization
- Claude Code context degradation detected
- Pre-deployment environment validation
- Periodic maintenance (recommended: weekly)

**Prerequisites**:

- Access to project directory and documentation files
- Understanding of project context and goals
- Agent mesh availability (agent-meta-engineer, directory-monitor, documentation-specialist)
- MCP server integration (optional but recommended)

**Enhanced Workflow**:

### Phase 1: Intelligent Discovery & Context Mapping

1. **Deep Project Analysis**:
   - Scan directory structure with pattern recognition
   - Analyze codebase architecture and technology stack
   - Identify documentation gaps and inconsistencies
   - Map existing agent mesh integration points
   - Detect Claude Code configuration opportunities

2. **Context Intelligence Gathering**:
   - Extract project goals and user personas from existing docs
   - Analyze commit history and development patterns
   - Identify productivity bottlenecks and optimization opportunities
   - Map team workflow preferences and conventions
   3- Assess current Claude environment effectiveness

### Phase 2: Strategic Optimization & Enhancement

3. **CLAUDE.md Intelligence Enhancement**:
   - Optimize for Claude Code context retention and understanding
   - Integrate agent mesh orchestration patterns
   - Add productivity-focused quick reference sections
   - Implement intelligent memory management strategies
   - Configure output styles and behavior preferences

4. **Multi-Document Consistency Engine**:
   - Align README.md with enhanced project architecture
   - Synchronize all markdown documentation for consistency
   - Update agent configurations with project-specific optimizations
   - Ensure AgentOS standards compliance across all files

### Phase 3: Advanced Integration & Validation

5. **Agent Mesh Integration**:
   - Configure specialized agents for project-specific workflows
   - Set up automated triggers and quality gates
   - Optimize agent tool permissions and boundaries
   - Implement cross-agent communication protocols

6. **Claude Environment Optimization**:
   - Configure MCP server integrations where available
   - Set up project-level memory management
   - Optimize context window usage and token efficiency
   - Implement productivity tracking and analytics setup

7. **Quality Assurance & Standards Validation**:
   - Validate against Fortium configuration standards
   - Run automated consistency checks across all documentation
   - Verify agent mesh functionality and integration
   - Test Claude Code productivity improvements

**Enhanced Output**:

### Primary Deliverables

- **CLAUDE.md**: Optimized with intelligent context management, agent orchestration, and productivity enhancements
- **README.md**: Aligned with current project status, enhanced with productivity metrics and clear workflow guidance
- **Agent Configurations**: Project-specific optimizations for all applicable specialized agents
- **Documentation Ecosystem**: Consistent, synchronized documentation across all project files

### Advanced Optimizations

- **Memory Management**: Configured project-level memory imports and context retention strategies
- **Agent Mesh**: Optimized agent tool permissions, boundaries, and orchestration workflows
- **Productivity Tracking**: Embedded analytics and improvement measurement frameworks
- **MCP Integration**: Configured external server integrations for enhanced capabilities
- **Quality Gates**: Automated validation and consistency checking mechanisms

**Advanced Integration**:

### Claude Code Ecosystem

- **Universal Compatibility**: Works with any project structure and technology stack
- **Memory System**: Leverages Claude Code memory management and project-level imports
- **Agent Mesh**: Full integration with 17+ specialized agents and orchestration patterns
- **MCP Protocol**: Compatible with Context7, Playwright, Linear, and other MCP servers
- **Output Styles**: Configures optimal response formats for maximum productivity

### Fortium Standards Compliance

- **AgentOS Integration**: Full compliance with .agent-os product management standards
- **Quality Framework**: Implements Fortium's productivity enhancement methodology
- **Documentation Standards**: Follows established patterns and best practices
- **Measurement Framework**: Embedded productivity tracking and improvement analytics

**Measurable Performance Impact**:

### Immediate Gains (0-7 days)

- **Project Onboarding**: 40% reduction in time to productive development
- **Context Understanding**: 60% improvement in Claude Code comprehension accuracy
- **Documentation Quality**: 80% reduction in documentation inconsistencies
- **Agent Efficiency**: 50% faster task delegation and completion

### Sustained Benefits (7-30 days)

- **Development Velocity**: 30% increase in feature delivery speed
- **Error Reduction**: 70% fewer configuration-related development issues
- **Team Productivity**: 35% improvement in cross-team collaboration efficiency
- **Maintenance Overhead**: 60% reduction in documentation maintenance time

### Long-term Optimization (30+ days)

- **Knowledge Retention**: 90% improvement in project context preservation
- **Scalability**: 2x faster onboarding of new team members
- **Quality Consistency**: 95% adherence to established development standards
- **Innovation Focus**: 40% more time available for feature development vs maintenance

## Advanced Features & Capabilities

### Intelligent Context Management

#### Adaptive Memory System

- **Dynamic Context Sizing**: Automatically optimizes context window usage based on project complexity
- **Hierarchical Memory**: Structures project knowledge in layers (core concepts → detailed implementation → edge cases)
- **Context Degradation Detection**: Monitors Claude's understanding quality and triggers refresh cycles
- **Selective Context Loading**: Intelligently includes/excludes content based on current task requirements

#### Smart Documentation Analysis

- **Semantic Gap Detection**: Identifies missing links between documentation sections
- **Consistency Engine**: Cross-references terminology and concepts across all project documents
- **Version Drift Monitoring**: Tracks documentation freshness relative to code changes
- **Knowledge Graph Generation**: Maps project concepts and their relationships for optimal context structuring

### Agent Mesh Orchestration Integration

#### Intelligent Delegation Patterns

```yaml
Primary Agents:
  - agent-meta-engineer: Orchestrates complex multi-phase optimization
  - general-purpose: Handles ambiguous scope and cross-domain analysis
  - documentation-specialist: Focuses on content quality and consistency

Supporting Agents:
  - directory-monitor: Provides real-time change detection and triggering
  - context-fetcher: Pulls authoritative references and external documentation
  - file-creator: Handles template generation and scaffolding
```

#### Orchestration Workflow

1. **Agent-Meta-Engineer Initialization**: Analyzes scope and delegates to appropriate specialists
2. **Parallel Processing**: Multiple agents work simultaneously on different optimization aspects
3. **Cross-Agent Validation**: Results validated across agent boundaries for consistency
4. **Conflict Resolution**: agent-meta-engineer arbitrates conflicting recommendations
5. **Quality Gate Enforcement**: Final validation through code-reviewer patterns

### Claude Code Environment Optimization

#### Memory Management Strategy

- **Project-Level Imports**: Configures optimal CLAUDE.md structure for memory system
- **Context Chunking**: Breaks large projects into manageable context segments
- **Priority Weighting**: Emphasizes critical project information in memory hierarchy
- **Refresh Triggers**: Sets up automated memory refresh based on project changes

#### Productivity Enhancement Features

- **Output Style Optimization**: Configures response formats for maximum development efficiency
- **Tool Permission Optimization**: Right-sizes agent capabilities for project requirements
- **MCP Integration Setup**: Configures external servers (Context7, Playwright, Linear) where available
- **Analytics Framework**: Embeds productivity tracking and continuous improvement metrics

### Quality Assurance Framework

#### Multi-Level Validation

1. **Syntax Validation**: YAML frontmatter, markdown structure, and format compliance
2. **Content Coherence**: Cross-document consistency and logical flow verification
3. **Agent Mesh Integration**: Validates agent configurations and orchestration patterns
4. **Fortium Standards**: Ensures compliance with established productivity frameworks
5. **Performance Impact**: Measures and validates productivity improvement metrics

#### Continuous Improvement Engine

- **Usage Pattern Analysis**: Tracks how optimizations impact actual development workflows
- **Feedback Integration**: Incorporates team feedback into future optimization cycles
- **Metric-Driven Refinement**: Uses productivity data to guide enhancement priorities
- **A/B Testing Framework**: Tests optimization strategies to validate effectiveness

## Usage Guidelines

### When to Execute

- **New Project Setup**: Essential for establishing optimal Claude environment
- **Context Degradation**: When Claude Code understanding seems diminished
- **Major Architecture Changes**: After significant project restructuring
- **Team Onboarding**: Before adding new team members to project
- **Performance Reviews**: Regular optimization cycles (recommended: monthly)

### Execution Best Practices

1. **Pre-Execution Backup**: Always backup existing configuration before optimization
2. **Incremental Validation**: Test optimizations in stages rather than all at once
3. **Team Coordination**: Coordinate with team before major documentation changes
4. **Performance Baseline**: Establish metrics before optimization for impact measurement
5. **Rollback Preparation**: Maintain ability to revert changes if needed

### Integration with Development Workflow

- **CI/CD Integration**: Can be triggered automatically on major project milestones
- **Git Hook Integration**: Optionally triggered on significant documentation changes
- **Team Workflow**: Coordinates with existing development processes and tools
- **Quality Gates**: Integrates with code review and deployment approval processes

## Technical Implementation

### Command Execution Framework

#### Phase-Based Execution

```bash
# Automatic agent delegation pattern
/fold-prompt → agent-meta-engineer analyzes scope → delegates to specialists

# Manual phase execution (advanced users)
/fold-prompt --phase=discovery    # Phase 1: Discovery & Context Mapping
/fold-prompt --phase=optimization # Phase 2: Strategic Optimization
/fold-prompt --phase=integration  # Phase 3: Advanced Integration
/fold-prompt --phase=validation   # Quality Assurance & Validation
```

#### Agent Coordination Protocol

1. **Agent-Meta-Engineer Assessment**: Determines complexity and required specialist agents
2. **Resource Allocation**: Assigns appropriate tools and permissions to each agent
3. **Parallel Execution**: Coordinates simultaneous optimization across multiple agents
4. **Result Synthesis**: Combines and validates outputs from all participating agents
5. **Quality Gate**: Final validation through code-reviewer and documentation-specialist

### Configuration Management

#### Project-Specific Optimization Profiles

```yaml
# .claude/fold-prompt-config.yml
project_profile:
  complexity: enterprise # simple | moderate | enterprise
  tech_stack: [react, rails, postgres]
  team_size: large # small | medium | large
  documentation_style: comprehensive
  optimization_priorities:
    - context_retention: high
    - agent_mesh_integration: high
    - productivity_tracking: medium
    - mcp_integration: low

agent_preferences:
  primary_documentation: documentation-specialist
  code_quality_enforcement: code-reviewer
  architecture_analysis: tech-lead-orchestrator

performance_targets:
  onboarding_time_reduction: 40%
  context_understanding_improvement: 60%
  documentation_consistency: 95%
```

#### Adaptive Behavior Engine

- **Learning System**: Tracks optimization effectiveness and adjusts future recommendations
- **Team Preferences**: Adapts to team-specific workflow patterns and documentation styles
- **Performance Feedback**: Uses productivity metrics to refine optimization strategies
- **Context Sensitivity**: Adjusts behavior based on project phase (startup → growth → enterprise)

## Standards Compliance Framework

### Fortium Quality Standards

- **AgentOS Compliance**: Full integration with `.agent-os/product/` management system
- **Documentation Standards**: Follows established markdown formatting and structure patterns
- **Agent Mesh Integration**: Complies with agent tool permission and boundary policies
- **Productivity Framework**: Implements measurable improvement tracking and validation

### Industry Best Practices

- **DRY Principle**: Eliminates documentation duplication and inconsistency
- **Single Source of Truth**: Establishes clear information hierarchy and authority
- **Version Control Integration**: Maintains change history and rollback capabilities
- **Continuous Improvement**: Implements feedback loops and iterative enhancement

### Security & Maintenance

- **Permission Management**: Right-sizes agent capabilities to minimize security exposure
- **Backup Strategy**: Automatic configuration backup before major optimizations
- **Rollback Procedures**: Clear processes for reverting changes if needed
- **Access Control**: Respects existing project access patterns and permissions

## Troubleshooting & Support

### Common Issues & Solutions

#### Context Degradation Detection

**Symptoms**: Claude Code responses become less accurate or miss project-specific context
**Solution**: Execute fold-prompt with focus on memory management and context restructuring
**Prevention**: Schedule regular optimization cycles (recommended: monthly)

#### Agent Mesh Conflicts

**Symptoms**: Multiple agents providing contradictory recommendations
**Solution**: Agent-Meta-Engineer conflict resolution protocols automatically arbitrate
**Prevention**: Maintain clear agent boundaries and tool permissions

#### Documentation Drift

**Symptoms**: Inconsistencies between README.md, CLAUDE.md, and project reality
**Solution**: Consistency engine automatically detects and resolves documentation gaps
**Prevention**: Integrate fold-prompt with CI/CD pipeline for automatic maintenance

### Performance Optimization Tips

1. **Baseline Measurement**: Always establish performance metrics before optimization
2. **Incremental Changes**: Apply optimizations gradually to identify most impactful improvements
3. **Team Feedback Integration**: Incorporate developer feedback to refine optimization strategies
4. **Regular Maintenance**: Schedule periodic optimization cycles to prevent performance degradation
5. **Context Window Management**: Monitor and optimize Claude Code context usage for efficiency

---

**Command Version**: 2.1 - Enhanced Agent Mesh Integration
**Last Updated**: August 2025
**Compatibility**: Claude Code 1.0+, Agent Mesh 17+, AgentOS 4.0+
**Maintainer**: Fortium Configuration Team
