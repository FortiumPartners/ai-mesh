---
name: create-trd
description: Take an existing PRD (generated by /plan-product) and delegate to tech-lead-orchestrator for technical requirements, architecture design, and implementation planning. Saves output to @docs/TRD/
---

## Mission

This command takes a comprehensive Product Requirements Document (PRD) created by the `/create-prd` command and delegates it to the  product-management-orchastrator via ai-mesh-orchestrator for technical planning, architecture design, and implementation breakdown. All outputs are automatically saved to `@docs/TRD/` directory for easy reference and version control.

## Workflow

### Phase 1: PRD Analysis & Validation
1. **PRD Ingestion**: Parse and analyze existing PRD document
2. **Requirements Validation**: Ensure completeness of functional and non-functional requirements
3. **Acceptance Criteria Review**: Validate testable acceptance criteria
4. **Context Preparation**: Prepare PRD for technical planning delegation

### Phase 2: Agent Mesh Delegation
1. **AI Mesh Orchestrator**: Route validated PRD to ai-mesh-orchestrator
2. **Tech Lead Orchestrator**: Delegate technical planning and architecture design
3. **TRD Generation**: Generate Technical Requirements Document (TRD)
4. **Task Breakdown**: Create actionable development tasks with estimates and **checkboxes**
5. **Implementation Planning**: Develop sprint planning with **trackable task lists**

### Phase 3: Output Management
1. **TRD Creation**: Generate comprehensive TRD document with project-specific naming
2. **File Organization**: Save to `@docs/TRD/` directory with descriptive filename
3. **Version Control**: Include timestamp and PRD reference for traceability
4. **Documentation Links**: Update cross-references between PRD and TRD documents

## Expected PRD Input Format

This command expects a PRD generated by `/plan-product` with the following structure:

### Required Sections
- **Product Summary**: Problem statement, solution overview, value proposition
- **User Analysis**: Primary users, personas, pain points, user journey
- **Goals & Non-Goals**: Primary objectives, success criteria, scope boundaries
- **Technical Requirements**: Functional and non-functional requirements
- **Acceptance Criteria**: Measurable success criteria with test scenarios
- **Implementation Planning**: Phases, timeline, constraints
- **Risk Assessment**: Technical and business risks with mitigation strategies

## TRD Output Format with Detailed Task Tracking

The generated TRD will include comprehensive task tracking with unique task IDs, dependencies, and completion tracking:

### Master Task List Section
```markdown
# Master Task List

**Project Status**: ðŸŸ¡ In Progress | **Total Tasks**: 47 | **Completed**: 0 | **Remaining**: 47

## Task Summary by Category
- [ ] **Foundation Tasks**: 12 tasks (0 completed)
- [ ] **Backend Development**: 15 tasks (0 completed)
- [ ] **Frontend Development**: 10 tasks (0 completed)
- [ ] **Testing & Quality**: 8 tasks (0 completed)
- [ ] **Documentation**: 2 tasks (0 completed)

## All Tasks (Detailed)

### Foundation Tasks (12 tasks)
- [ ] **TRD-001**: Environment setup and development tools (4h) - Priority: High
- [ ] **TRD-002**: Repository structure and git workflow setup (2h) - Priority: High
- [ ] **TRD-003**: CI/CD pipeline configuration (6h) - Priority: Medium - Depends: TRD-002
- [ ] **TRD-004**: Database schema design and migration setup (8h) - Priority: High
- [ ] **TRD-005**: Authentication system architecture (6h) - Priority: High - Depends: TRD-004
- [ ] **TRD-006**: API framework and middleware configuration (4h) - Priority: High - Depends: TRD-001
- [ ] **TRD-007**: Logging and monitoring setup (4h) - Priority: Medium - Depends: TRD-006
- [ ] **TRD-008**: Error handling and validation framework (3h) - Priority: Medium - Depends: TRD-006
- [ ] **TRD-009**: Security headers and CORS configuration (2h) - Priority: High - Depends: TRD-006
- [ ] **TRD-010**: Environment configuration management (3h) - Priority: High - Depends: TRD-001
- [ ] **TRD-011**: Testing framework setup and configuration (4h) - Priority: High - Depends: TRD-001
- [ ] **TRD-012**: Code quality tools (ESLint, Prettier, Husky) (2h) - Priority: Medium - Depends: TRD-002

### Backend Development Tasks (15 tasks)
- [ ] **TRD-013**: User registration API endpoint (4h) - Priority: High - Depends: TRD-005
- [ ] **TRD-014**: User login/logout API endpoints (4h) - Priority: High - Depends: TRD-005
- [ ] **TRD-015**: JWT token management service (3h) - Priority: High - Depends: TRD-005
- [ ] **TRD-016**: Password hashing and validation (2h) - Priority: High - Depends: TRD-005
- [ ] **TRD-017**: User profile management APIs (6h) - Priority: Medium - Depends: TRD-013
- [ ] **TRD-018**: Role-based access control (RBAC) (8h) - Priority: Medium - Depends: TRD-015
- [ ] **TRD-019**: Session management and refresh tokens (4h) - Priority: Medium - Depends: TRD-015
- [ ] **TRD-020**: API rate limiting implementation (3h) - Priority: Medium - Depends: TRD-008
- [ ] **TRD-021**: Input validation middleware (4h) - Priority: High - Depends: TRD-008
- [ ] **TRD-022**: Database connection pooling (2h) - Priority: Medium - Depends: TRD-004
- [ ] **TRD-023**: Audit logging for user actions (3h) - Priority: Medium - Depends: TRD-007
- [ ] **TRD-024**: Email service integration (4h) - Priority: Low - Depends: TRD-010
- [ ] **TRD-025**: File upload handling (5h) - Priority: Low - Depends: TRD-021
- [ ] **TRD-026**: Data export/import functionality (6h) - Priority: Low - Depends: TRD-018
- [ ] **TRD-027**: Health check and metrics endpoints (2h) - Priority: Medium - Depends: TRD-007

### Frontend Development Tasks (10 tasks)
- [ ] **TRD-028**: Login form component with validation (4h) - Priority: High - Depends: TRD-014
- [ ] **TRD-029**: Registration form component (4h) - Priority: High - Depends: TRD-013
- [ ] **TRD-030**: User dashboard layout (6h) - Priority: Medium - Depends: TRD-017
- [ ] **TRD-031**: Navigation and routing setup (3h) - Priority: High - Depends: TRD-028
- [ ] **TRD-032**: Authentication state management (4h) - Priority: High - Depends: TRD-028
- [ ] **TRD-033**: Form validation and error handling (3h) - Priority: Medium - Depends: TRD-029
- [ ] **TRD-034**: Responsive design implementation (5h) - Priority: Medium - Depends: TRD-030
- [ ] **TRD-035**: Loading states and user feedback (2h) - Priority: Low - Depends: TRD-032
- [ ] **TRD-036**: Profile management interface (4h) - Priority: Low - Depends: TRD-030
- [ ] **TRD-037**: Session timeout handling (3h) - Priority: Medium - Depends: TRD-032

### Testing & Quality Tasks (8 tasksctx7sk-06e93fbd-e075-4f43-859c-bcc44ce1e9ec)
- [ ] **TRD-038**: Unit tests for authentication APIs (4h) - Priority: High - Depends: TRD-014
- [ ] **TRD-039**: Unit tests for user management (3h) - Priority: High - Depends: TRD-017
- [ ] **TRD-040**: Integration tests for API workflows (6h) - Priority: High - Depends: TRD-038
- [ ] **TRD-041**: Frontend component testing (4h) - Priority: Medium - Depends: TRD-029
- [ ] **TRD-042**: E2E tests for user authentication flow (6h) - Priority: High - Depends: TRD-040
- [ ] **TRD-043**: Security testing and vulnerability assessment (4h) - Priority: High - Depends: TRD-042
- [ ] **TRD-044**: Performance testing and optimization (5h) - Priority: Medium - Depends: TRD-043
- [ ] **TRD-045**: Code coverage analysis and reporting (2h) - Priority: Medium - Depends: TRD-041

### Documentation Tasks (2 tasks)
- [ ] **TRD-046**: API documentation with Swagger/OpenAPI (3h) - Priority: Medium - Depends: TRD-027
- [ ] **TRD-047**: User guide and deployment documentation (4h) - Priority: Low - Depends: TRD-046
```

### Sprint Structure with Task References
```markdown
## Sprint 1: Foundation Setup (Week 1)
**Duration**: 5 days | **Total Estimate**: 42 hours | **Tasks**: TRD-001 to TRD-012

### Primary Tasks
- [ ] **TRD-001**: Environment setup and development tools (4h)
- [ ] **TRD-002**: Repository structure and git workflow setup (2h)
- [ ] **TRD-004**: Database schema design and migration setup (8h)
- [ ] **TRD-005**: Authentication system architecture (6h)
- [ ] **TRD-006**: API framework and middleware configuration (4h)
- [ ] **TRD-010**: Environment configuration management (3h)
- [ ] **TRD-011**: Testing framework setup and configuration (4h)

### Secondary Tasks
- [ ] **TRD-003**: CI/CD pipeline configuration (6h) - Can start after TRD-002
- [ ] **TRD-007**: Logging and monitoring setup (4h) - Can start after TRD-006
- [ ] **TRD-012**: Code quality tools (ESLint, Prettier, Husky) (2h) - Can start after TRD-002

### Sprint Goals
- [ ] Complete development environment setup (TRD-001, TRD-002, TRD-010, TRD-011)
- [ ] Database design approved and implemented (TRD-004)
- [ ] Authentication architecture designed (TRD-005)
- [ ] API framework operational (TRD-006)
- [ ] Code quality pipeline established (TRD-012)

### Definition of Done
- [ ] All primary tasks (TRD-001, TRD-002, TRD-004, TRD-005, TRD-006, TRD-010, TRD-011) completed
- [ ] Development environment setup validated by team
- [ ] Database migrations run successfully
- [ ] API framework responds to health checks
- [ ] Code quality tools enforce standards on commits
```

### Task Status Tracking
```markdown
## Task Completion Status

**Last Updated**: [AUTO-GENERATED TIMESTAMP]
**Completion Rate**: 0% (0 of 47 tasks completed)

### Recently Completed Tasks
None yet.

### In Progress Tasks
None yet.

### Blocked Tasks
None identified.

### Next Priority Tasks
1. **TRD-001**: Environment setup and development tools (4h) - Ready to start
2. **TRD-002**: Repository structure and git workflow setup (2h) - Ready to start
3. **TRD-010**: Environment configuration management (3h) - Ready to start
4. **TRD-011**: Testing framework setup and configuration (4h) - Ready to start
```

### Example PRD Reference
See `/docs/PRD/python-to-nodejs-hooks-conversion.md` for a complete example of the expected PRD format that this command processes.

## Usage Examples

### Using Existing PRD File
```
/create-trd /docs/PRD/python-to-nodejs-hooks-conversion.md
# Output saved to: /docs/TRD/python-to-nodejs-hooks-conversion-trd.md
```

### Using PRD from plan-product Command
```
# First, generate PRD with plan-product
/plan-product "Convert Python hooks to Node.js for simplified installation"

# Then convert to TRD with the generated PRD
/create-trd /docs/PRD/python-hooks-conversion-prd.md
# Output saved to: /docs/TRD/python-hooks-conversion-trd.md
```

### Multiple PRDs Implementation
```
/create-trd /docs/PRD/user-authentication-system.md
# Output saved to: /docs/TRD/user-authentication-system-trd.md

/create-trd /docs/PRD/analytics-dashboard.md
# Output saved to: /docs/TRD/analytics-dashboard-trd.md

/create-trd /docs/PRD/real-time-collaboration.md
# Output saved to: /docs/TRD/real-time-collaboration-trd.md
```

## Agent Delegation Flow

```
User Request â†’ create-trd /path/to/existing-prd.md
    â†“
Read and Parse Existing PRD Document
    â†“
Validate PRD Completeness and Format
    â†“
Task(ai-mesh-orchestrator, "Take this validated PRD and delegate to tech-lead-orchestrator for complete technical planning, architecture design, and implementation breakdown")
    â†“
ai-mesh-orchestrator analyzes PRD requirements and delegates to tech-lead-orchestrator
    â†“
tech-lead-orchestrator follows Phase 1-3 methodology:
  â€¢ Phase 1: Plan & Requirements Analysis
  â€¢ Phase 2: Architecture Design
  â€¢ Phase 3: Task Breakdown & Sprint Planning with Checkbox Tracking
    â†“
Generate comprehensive TRD document
    â†“
Save TRD to @docs/TRD/ with descriptive filename
    â†“
Return complete TRD path and summary to user
```

## Task ID System

Each TRD generates unique task IDs following the pattern: **TRD-###** where ### is a zero-padded 3-digit number (TRD-001, TRD-002, etc.)

### Task Metadata Structure
```markdown
- [ ] **TRD-XXX**: Task Description (Xh) - Priority: [High|Medium|Low] - Depends: [TRD-YYY, TRD-ZZZ]
```

### Task Categories
- **TRD-001 to TRD-020**: Foundation and Infrastructure
- **TRD-021 to TRD-040**: Core Development (Backend/Frontend)
- **TRD-041 to TRD-060**: Testing and Quality Assurance
- **TRD-061 to TRD-080**: Documentation and Deployment
- **TRD-081+**: Extended/Optional Features

### Integration with /implement-trd
The implement-trd command will:
1. Parse TRD files for task lists with checkbox tracking
2. Track completion status by updating checkboxes in real-time
3. Monitor dependencies and enable ready tasks
4. Update completion statistics automatically
5. Archive completed projects to @docs/TRD/completed/ and @docs/PRD/completed/

## Success Criteria

- **PRD Validation**: Existing PRD parsed and validated for completeness
- **Technical Requirements**: TRD generated with system architecture and constraints
- **Task Breakdown**: Development tasks with 2-8 hour estimates, unique IDs, and dependencies
- **Sprint Planning**: Organized sprints with clear deliverables and quality gates
- **TRD Documentation**: Complete TRD saved to `@docs/TRD/` with descriptive naming and task tracking
- **Implementation Ready**: Complete technical plan suitable for development team handoff
- **Task Integration**: TRD includes detailed task list compatible with /implement-trd workflow

## Integration Points

- **Plan-Product Integration**: Designed to work with PRDs generated by `/plan-product` command
- **AgentOS Standards**: Follows TRD template from docs/agentos/TRD.md
- **Documentation Organization**: Saves TRD output to structured `@docs/TRD/` directory
- **Context7 Integration**: Pulls relevant technical documentation and examples
- **Linear Integration**: Creates technical epics and implementation stories
- **Git Workflow Integration**: Generates branch strategy and commit planning

## Quality Gates

- PRD format and completeness validation
- Requirements technical feasibility assessment
- Acceptance criteria implementation validation
- Architecture design review and approval
- Task breakdown granularity verification (2-8 hour tasks)
- Sprint dependency mapping validation

## Implementation Example

Using the Python to Node.js hooks conversion PRD (`/docs/PRD/python-to-nodejs-hooks-conversion.md`), the command would:

1. **Parse PRD sections**: Extract user analysis, technical requirements, acceptance criteria
2. **Validate completeness**: Ensure all required sections present and detailed
3. **Delegate to tech-lead-orchestrator**: Route PRD with full context for technical planning
4. **Generate outputs**:
   - Technical Requirements Document (TRD)
   - System architecture design
   - Task breakdown (analytics-engine.py â†’ analytics-engine.js conversion, etc.)
   - Sprint planning with 5-week timeline
   - Quality gates and testing strategy
5. **Save TRD**: Output saved to `/docs/TRD/python-to-nodejs-hooks-conversion-trd.md` with timestamp and PRD reference

## Notes

- Expects PRD input from `/plan-product` command or compatible format
- Validates PRD completeness before technical delegation
- Leverages tech-lead-orchestrator's full Phase 1-3 methodology
- Maintains traceability from PRD requirements through implementation tasks
- Integrates with existing agent mesh for specialized technical planning
